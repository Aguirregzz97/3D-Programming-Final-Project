<!DOCTYPE html>
<html>
	<head>
		<title>Proyecto Final Graficas</title>
		<style>
			body { margin: 0; }
			canvas { display: block; }
		</style>
	</head>
	<body>
		<script src="js/three.js"></script>
		<script src="js/OrbitControls.js"></script>
		<script>

			// Creating the scene with a prespective camera
			const scene = new THREE.Scene()

			const camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 )
			camera.position.z = 9.5
			camera.position.x = 0.1
			camera.position.y = 1.5

			// creating the renderer with it's size
			const renderer = new THREE.WebGLRenderer()
			renderer.setSize(window.innerWidth, window.innerHeight)
			renderer.setClearColor('#e5e5e5')
			
			// set renderer to cast shadows
			renderer.shadowMapEnabled = true

			// appending renderer to DOM
			document.body.appendChild( renderer.domElement )

			const controls = new THREE.OrbitControls( camera, renderer.domElement );

			//controls.update() must be called after any manual changes to the camera's transform
			controls.update();

			function animate() {
				requestAnimationFrame( animate );
				// required if controls.enableDamping or controls.autoRotate are set to true
				controls.update();
				renderer.render( scene, camera );
			}

			// Listener to make scene responsive
			window.addEventListener('resize', () => {
				renderer.setSize(window.innerWidth, window.innerHeight)
				camera.aspect = window.innerWidth / window.innerHeight
				camera.updateProjectionMatrix()
			})

			// Add light to our scene
			var light = new THREE.SpotLight(0xFFFFFF, 1.3, 1000)
			light.castShadow = true
			light.shadow.mapSize.width = 2048
			light.shadow.mapSize.height = 2048
			light.position.set(10, 5, 9)
			scene.add(light)

			// creating WINDOWS LEFT
			var y = 1.2
			for (let i = 0; i < 6; i++) {
				var geometry = new THREE.BoxGeometry(0.2, 0.2, 1)
				var material = new THREE.MeshLambertMaterial({ color: 0xFFFFFF })
				var mesh = new THREE.Mesh(geometry, material)

				mesh.position.x = 2.25
				mesh.position.y = y
				mesh.position.z = 0.07

				// add objecty to scene
				scene.add(mesh)

				y -= .4
			}

			// creating WINDOWS RIGHT
			var y = 1.2
			for (let i = 0; i < 6; i++) {
				var geometry = new THREE.BoxGeometry(0.2, 0.2, 1)
				var material = new THREE.MeshLambertMaterial({ color: 0xFFFFFF })
				var mesh = new THREE.Mesh(geometry, material)

				mesh.position.x = 2.7
				mesh.position.y = y
				mesh.position.z = 0.05

				// add objecty to scene
				scene.add(mesh)

				y -= .4
			}

			// create door
			geometry = new THREE.BoxGeometry(0.2, 0.4, 1)
			material = new THREE.MeshLambertMaterial({ color: 0x8B4513 })
			mesh = new THREE.Mesh(geometry, material)

			mesh.position.x = 2.5
			mesh.position.z = 0.05
			mesh.position.y = -1.28

			// add object to scene
			scene.add(mesh)


			// create building
			geometry = new THREE.BoxGeometry(1, 3, 1)
			material = new THREE.MeshLambertMaterial({ color: 0x32527b })
			mesh = new THREE.Mesh(geometry, material)

			mesh.position.x = 2.5

			mesh.castShadow = true
			mesh.receiveShadow = true

			// add objecty to scene
			scene.add(mesh)

			//********************************
			//Edificio 2

			// creating WINDOWS LEFT
			var y = 1.2
			for (let i = 0; i < 6; i++) {
				var geometry = new THREE.BoxGeometry(0.2, 0.2, 1)
				var material = new THREE.MeshLambertMaterial({ color: 0xFFFFFF })
				var mesh = new THREE.Mesh(geometry, material)

				mesh.position.x = -2.25
				mesh.position.y = y
				mesh.position.z = 0.07

				// add objecty to scene
				scene.add(mesh)

				y -= .4
			}

			// creating WINDOWS RIGHT
			var y = 1.2
			for (let i = 0; i < 6; i++) {
				var geometry = new THREE.BoxGeometry(0.2, 0.2, 1)
				var material = new THREE.MeshLambertMaterial({ color: 0xFFFFFF })
				var mesh = new THREE.Mesh(geometry, material)

				mesh.position.x = -2.7
				mesh.position.y = y
				mesh.position.z = 0.05

				// add objecty to scene
				scene.add(mesh)

				y -= .4
			}

			// create door
			geometry = new THREE.BoxGeometry(0.2, 0.4, 1)
			material = new THREE.MeshLambertMaterial({ color: 0x8B4513 })
			mesh = new THREE.Mesh(geometry, material)

			mesh.position.x = -2.5
			mesh.position.z = 0.05
			mesh.position.y = -1.28

			// add object to scene
			scene.add(mesh)


			// create building
			geometry = new THREE.BoxGeometry(1, 3, 1)
			material = new THREE.MeshLambertMaterial({ color: 0x32527b })
			mesh = new THREE.Mesh(geometry, material)

			mesh.position.x = -2.5

			mesh.castShadow = true
			mesh.receiveShadow = true

			// add objecty to scene
			scene.add(mesh)

			//Edificio 3******************************

			// creating WINDOWS LEFT
			var y = 0.4
			for (let i = 0; i < 4; i++) {
				var geometry = new THREE.BoxGeometry(0.2, 0.2, 1)
				var material = new THREE.MeshLambertMaterial({ color: 0xFFFFFF })
				var mesh = new THREE.Mesh(geometry, material)

				mesh.position.x = -1.2
				mesh.position.y = y
				mesh.position.z = 0.07

				// add objecty to scene
				scene.add(mesh)

				y -= .4
			}
			// creating WINDOWS RIGHT
			var y = 0.4
			for (let i = 0; i < 4; i++) {
				var geometry = new THREE.BoxGeometry(0.2, 0.2, 1)
				var material = new THREE.MeshLambertMaterial({ color: 0xFFFFFF })
				var mesh = new THREE.Mesh(geometry, material)

				mesh.position.x = -0.8
				mesh.position.y = y
				mesh.position.z = 0.07

				// add objecty to scene
				scene.add(mesh)

				y -= .4
			}

			// create door
			geometry = new THREE.BoxGeometry(0.2, 0.4, 1)
			material = new THREE.MeshLambertMaterial({ color: 0x8B4513 })
			mesh = new THREE.Mesh(geometry, material)

			mesh.position.x = -1
			mesh.position.z = 0.05
			mesh.position.y = -1.3

			// add object to scene
			scene.add(mesh)


			// create building
			geometry = new THREE.BoxGeometry(1, 2.2, 1)
			material = new THREE.MeshLambertMaterial({ color: 0x32527b })
			mesh = new THREE.Mesh(geometry, material)

			mesh.position.x = -1
			mesh.position.y = -.35

			mesh.castShadow = true
			mesh.receiveShadow = true


			// add objecty to scene
			scene.add(mesh)


			//**********************************
			//PIKACHU

			// cuerpo
			geometry = new THREE.BoxGeometry(0.5, 0.5, 1)

			// instantiate a loader
			var loader = new THREE.TextureLoader();

			// load a resource
			const pikachu_texture = loader.load('textures/pikachu_face.png',
				function ( texture ) {
					// we create the material when the texture is loaded
					const material = new THREE.MeshBasicMaterial( { map: texture } );
				},
				// onProgress callback currently not supported
				undefined,
				// onError callback
				function ( err ) {
					console.error( 'Error cargando la textura del piso.' );
				}
			);


			var materials = [
			 new THREE.MeshLambertMaterial({ color: 0xedd80b }),
       new THREE.MeshLambertMaterial({ color: 0xedd80b }),
       new THREE.MeshLambertMaterial({ color: 0xedd80b }),
       new THREE.MeshLambertMaterial({ color: 0xedd80b }),
			 new THREE.MeshBasicMaterial({ map: pikachu_texture }),
       new THREE.MeshLambertMaterial({ color: 0xedd80b }),
       new THREE.MeshLambertMaterial({ color: 0xedd80b })
    ];
			mesh3 = new THREE.Mesh(geometry, materials)

			mesh3.position.x = 0.5
			mesh3.position.y = -1
			mesh3.position.z = 3

			mesh3.castShadow = true
			mesh3.receiveShadow = true

			scene.add(mesh3)


			// pie izquierdo-adelante
			geometry = new THREE.BoxGeometry(0.15, 0.2, .15)
			material = new THREE.MeshLambertMaterial({ color: 0xedd80b })
			mesh4 = new THREE.Mesh(geometry, material)

			mesh4.position.x = 0.33
			mesh4.position.y = -1.33
			mesh4.position.z = 3.42

			mesh4.castShadow = true
			mesh4.receiveShadow = true

			scene.add(mesh4)

			// pie derecho adelante
			geometry = new THREE.BoxGeometry(0.15, 0.2, .15)
			material = new THREE.MeshLambertMaterial({ color: 0xedd80b })
			mesh5 = new THREE.Mesh(geometry, material)

			mesh5.position.x = 0.685
			mesh5.position.y = -1.33
			mesh5.position.z = 3.42

			mesh5.castShadow = true
			mesh5.receiveShadow = true

			scene.add(mesh5)


			// pie derecho atras
			geometry = new THREE.BoxGeometry(0.15, 0.2, .15)
			material = new THREE.MeshLambertMaterial({ color: 0xedd80b })
			mesh6 = new THREE.Mesh(geometry, material)

			mesh6.position.x = 0.685
			mesh6.position.y = -1.33
			mesh6.position.z = 2.58

			mesh6.castShadow = true
			mesh6.receiveShadow = true

			scene.add(mesh6)


			// pie izq atras
			geometry = new THREE.BoxGeometry(0.15, 0.2, .15)
			material = new THREE.MeshLambertMaterial({ color: 0xedd80b })
			mesh7 = new THREE.Mesh(geometry, material)

			mesh7.position.x = 0.33
			mesh7.position.y = -1.33
			mesh7.position.z = 2.58

			mesh7.castShadow = true
			mesh7.receiveShadow = true

			scene.add(mesh7)


			// oreja izquierda negro
			geometry = new THREE.BoxGeometry(0.1, 0.3, .15)
			material = new THREE.MeshLambertMaterial({ color: 0xedd80b })
			mesh8 = new THREE.Mesh(geometry, material)

			mesh8.position.x = 0.33
			mesh8.position.y = -0.7
			mesh8.position.z = 3.4

			mesh8.castShadow = true
			mesh8.receiveShadow = true

			scene.add(mesh8)



			// oreja derecha amarillo
			geometry = new THREE.BoxGeometry(0.1, 0.3, .15)
			material = new THREE.MeshLambertMaterial({ color: 0xedd80b })
			mesh9 = new THREE.Mesh(geometry, material)

			mesh9.position.x = 0.685
			mesh9.position.y = -0.7
			mesh9.position.z = 3.4

			mesh9.castShadow = true
			mesh9.receiveShadow = true

			scene.add(mesh9)


			// oreja izq negro
			geometry = new THREE.BoxGeometry(0.1, 0.1, .15)
			material = new THREE.MeshLambertMaterial({ color: 0x48310e  })
			mesh10 = new THREE.Mesh(geometry, material)

			mesh10.position.x = 0.33
			mesh10.position.y = -0.5
			mesh10.position.z = 3.4

			mesh10.castShadow = true
			mesh10.receiveShadow = true

			scene.add(mesh10)


			// oreja der amarillo
			geometry = new THREE.BoxGeometry(0.1, 0.1, .15)
			material = new THREE.MeshLambertMaterial({ color: 0x48310e  })
			mesh11 = new THREE.Mesh(geometry, material)

			mesh11.position.x = 0.685
			mesh11.position.y = -0.5
			mesh11.position.z = 3.4

			mesh11.castShadow = true
			mesh11.receiveShadow = true

			scene.add(mesh11)

			// relampago
			geometry = new THREE.BoxGeometry(0.2, 0.5, .15)
			material = new THREE.MeshLambertMaterial({ color: 0xedd80b  })
			mesh12 = new THREE.Mesh(geometry, material)

			mesh12.position.x = .55
			mesh12.position.y = -0.6
			mesh12.position.z = 2.4

			scene.add(mesh12)


			geometry = new THREE.BoxGeometry(0.4, 0.3, .15)
			material = new THREE.MeshLambertMaterial({ color: 0xedd80b  })
			mesh13 = new THREE.Mesh(geometry, material)

			mesh13.position.x = 0.75
			mesh13.position.y = -0.38
			mesh13.position.z = 2.4

			mesh13.castShadow = true
			mesh13.receiveShadow = true

			scene.add(mesh13)


			//PISO
			// instantiate a loader
			var loader = new THREE.TextureLoader();

			// load a resource
			const floor_texture = loader.load('textures/floor_1.jpg',
				function ( texture ) {
					// we create the material when the texture is loaded
					const material = new THREE.MeshBasicMaterial( { map: texture } );
				},
				// onProgress callback currently not supported
				undefined,
				// onError callback
				function ( err ) {
					console.error( 'Error cargando la textura del piso.' );
				}
			);

			floor_texture.wrapS = THREE.RepeatWrapping;
			floor_texture.wrapT = THREE.RepeatWrapping;
			floor_texture.repeat.set( 4, 4 );

			//geometry = new THREE.BoxGeometry(20, 0.1, 20)
			geometry = new THREE.BoxGeometry(10, 0.1, 13)
			// material = new THREE.MeshBasicMaterial( { map: floor_texture } );
			material = new THREE.MeshLambertMaterial({ map: floor_texture })
			mesh2 = new THREE.Mesh(geometry, material)

			mesh2.position.x = 0
			mesh2.position.y = -1.5
			mesh2.position.z = 1

			mesh2.castShadow = true
			mesh2.receiveShadow = true

			scene.add(mesh2)

			//**********************************
			// Add light to our scene
			var light = new THREE.PointLight(0xFFFFFF, 1, 500)
			light.position.set(0, 0, 2)
			scene.add(light)

			// Add light to our scene
			var light = new THREE.PointLight(0xFFFFFF, 1, 500)
			light.position.set(10, 0, 25)
			scene.add(light)
			//**********************************


			
			var translation = 0.01

			// render scene and camera without distorting aspect ratio
			var render = () => {
				requestAnimationFrame(render)
				console.log(mesh3.position.z)
				if (mesh3.position.z >= 6) {
					translation *= -1
				}
				if (mesh3.position.z < 3) {
					translation *= -1
				}
				mesh3.position.z += translation
				mesh4.position.z += translation
				mesh5.position.z += translation
				mesh6.position.z += translation
				mesh7.position.z += translation
				mesh8.position.z += translation
				mesh9.position.z += translation
				mesh10.position.z += translation
				mesh11.position.z += translation
				mesh12.position.z += translation
				mesh13.position.z += translation
				renderer.render(scene, camera)
			}

			render()

		</script>
	</body>
</html>
